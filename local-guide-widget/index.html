<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Lovely Venice Apartments ‚Äì Local Guide</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

html, body {
  margin: 0;
  padding: 0;
  background: #ffffff;
  min-height: 100vh;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  color: #333;
  -webkit-font-smoothing: antialiased;
  line-height: 1.5;
}

#lv-container {
  max-width: 480px;
  margin: 0 auto;
  padding: 24px 20px;
}

/* HEADER - Stile Lodgify elegante */
#lv-header {
  text-align: center;
  margin-bottom: 28px;
  padding: 28px 24px;
  background: linear-gradient(135deg, #2c2c2c 0%, #1a1a1a 100%);
  border-radius: 16px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.15);
}

#lv-header-title {
  font-size: 22px;
  font-weight: 700;
  color: #fff;
  margin-bottom: 8px;
  letter-spacing: -0.3px;
}

#lv-header-subtitle {
  font-size: 14px;
  color: rgba(255,255,255,0.7);
  font-weight: 400;
}

/* SELECT - Stile pulito Lodgify */
#lv-menu-row {
  display: flex;
  gap: 12px;
  margin-bottom: 28px;
}

.lv-select {
  flex: 1;
  padding: 14px 16px;
  border-radius: 8px;
  border: 1px solid #ddd;
  font-size: 14px;
  font-weight: 500;
  background: #fff;
  color: #333;
  cursor: pointer;
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 14px center;
  padding-right: 40px;
  transition: all 0.2s;
}

.lv-select:focus {
  outline: none;
  border-color: #c0392b;
  box-shadow: 0 0 0 3px rgba(192, 57, 43, 0.1);
}

.lv-lang {
  width: 65px;
  padding: 14px 10px;
  border-radius: 8px;
  border: 1px solid #ddd;
  font-size: 14px;
  font-weight: 600;
  background: #fff;
  color: #333;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s;
}

.lv-lang:focus {
  outline: none;
  border-color: #c0392b;
}

/* SECTIONS */
.lv-section {
  margin-bottom: 32px;
}

.lv-section-title {
  font-size: 12px;
  font-weight: 700;
  color: #888;
  margin-bottom: 16px;
  text-transform: uppercase;
  letter-spacing: 1px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.lv-section-icon {
  font-size: 16px;
}

/* SUPERMARKET CARD - Verde elegante */
.lv-supermarket-card {
  background: #fff;
  border: 1px solid #e8e8e8;
  border-left: 4px solid #27ae60;
  border-radius: 12px;
  padding: 20px;
  display: flex;
  align-items: center;
  gap: 16px;
  transition: all 0.2s;
}

.lv-supermarket-card:hover {
  box-shadow: 0 4px 16px rgba(0,0,0,0.08);
}

.lv-supermarket-icon {
  font-size: 36px;
}

.lv-supermarket-info {
  flex: 1;
}

.lv-supermarket-name {
  font-size: 16px;
  font-weight: 600;
  color: #333;
  margin-bottom: 4px;
}

.lv-supermarket-distance {
  font-size: 13px;
  color: #666;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 4px;
}

.lv-supermarket-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: #27ae60;
  color: #fff;
  padding: 10px 20px;
  border-radius: 6px;
  text-decoration: none;
  font-size: 13px;
  font-weight: 600;
  transition: all 0.2s;
}

.lv-supermarket-btn:hover {
  background: #219a52;
}

/* RESTAURANT LIST */
.lv-restaurant-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.lv-restaurant-card {
  background: #fff;
  border: 1px solid #e8e8e8;
  border-radius: 12px;
  padding: 16px;
  display: flex;
  align-items: center;
  gap: 14px;
  transition: all 0.2s;
  cursor: pointer;
}

.lv-restaurant-card:hover {
  border-color: #c0392b;
  box-shadow: 0 4px 16px rgba(192, 57, 43, 0.1);
}

.lv-restaurant-card.selected {
  border-color: #c0392b;
  border-width: 2px;
  background: linear-gradient(135deg, #fff5f5 0%, #fff 100%);
  box-shadow: 0 4px 16px rgba(192, 57, 43, 0.12);
}

.lv-restaurant-icon {
  font-size: 28px;
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #f8f8f8;
  border-radius: 10px;
}

.lv-restaurant-card.selected .lv-restaurant-icon {
  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
}

.lv-restaurant-info {
  flex: 1;
  min-width: 0;
}

.lv-restaurant-name {
  font-size: 15px;
  font-weight: 600;
  color: #333;
  margin-bottom: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.lv-restaurant-card.selected .lv-restaurant-name {
  color: #c0392b;
}

.lv-restaurant-meta {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}

.lv-restaurant-distance {
  font-size: 12px;
  color: #888;
  font-weight: 500;
}

.lv-restaurant-distance::before {
  content: 'üö∂ ';
  font-size: 11px;
}

.lv-restaurant-status {
  font-size: 10px;
  font-weight: 700;
  padding: 4px 10px;
  border-radius: 4px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.lv-status-open {
  background: #e8f5e9;
  color: #2e7d32;
}

.lv-status-closing {
  background: #fff3e0;
  color: #e65100;
  animation: pulse-warning 2s infinite;
}

.lv-status-closed {
  background: #ffebee;
  color: #c62828;
}

@keyframes pulse-warning {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

.lv-restaurant-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 42px;
  height: 42px;
  background: #c0392b;
  color: #fff;
  border-radius: 8px;
  text-decoration: none;
  font-size: 16px;
  transition: all 0.2s;
  flex-shrink: 0;
}

.lv-restaurant-btn:hover {
  background: #a93226;
  transform: scale(1.05);
}

/* FOOTER */
.lv-footer {
  text-align: center;
  padding-top: 20px;
  margin-top: 12px;
}

.lv-footer-text {
  font-size: 12px;
  color: #aaa;
  font-weight: 500;
}

/* RESPONSIVE */
@media(max-width:480px){
  #lv-container { padding: 16px 14px; }
  #lv-header { padding: 22px 18px; }
  #lv-header-title { font-size: 20px; }
  .lv-supermarket-card { padding: 16px; flex-direction: column; text-align: center; }
  .lv-supermarket-icon { font-size: 32px; }
  .lv-supermarket-distance { justify-content: center; }
  .lv-restaurant-card { padding: 14px 12px; }
  .lv-restaurant-icon { width: 42px; height: 42px; font-size: 24px; }
  .lv-restaurant-name { font-size: 14px; }
  .lv-restaurant-btn { width: 38px; height: 38px; }
}
</style>
</head>
<body>

<div id="lv-container">

  <div id="lv-header">
    <div id="lv-header-title">üó∫Ô∏è Local Guide</div>
    <div id="lv-header-subtitle" data-i18n="subtitle">Supermercati e ristoranti vicino a te</div>
  </div>

  <div id="lv-menu-row">
    <select id="lv-apartment-select" class="lv-select">
      <option value="sweet">Sweet Dream Apartment</option>
      <option value="skyline">Skyline Apartment</option>
      <option value="dreamstudio">Dream Studio</option>
      <option value="station">Station Apartment</option>
    </select>
    <select id="lv-lang-select" class="lv-lang">
      <option value="it">IT</option>
      <option value="en">EN</option>
    </select>
  </div>

  <!-- SUPERMARKET -->
  <div class="lv-section">
    <div class="lv-section-title">
      <span class="lv-section-icon">üõí</span>
      <span data-i18n="supermarketTitle">Supermercato pi√π vicino</span>
    </div>
    <div id="lv-supermarket-container"></div>
  </div>

  <!-- RESTAURANTS -->
  <div class="lv-section">
    <div class="lv-section-title">
      <span class="lv-section-icon">üçΩÔ∏è</span>
      <span data-i18n="restaurantsTitle">Ristoranti consigliati</span>
    </div>
    <div id="lv-restaurant-list" class="lv-restaurant-list"></div>
  </div>

  <!-- FOOTER -->
  <div class="lv-footer">
    <div class="lv-footer-text">Lovely Venice Apartments ‚ù§Ô∏è</div>
  </div>

</div>

<script>
let LANG = "it";

const I18N = {
  it: {
    subtitle: "Supermercati e ristoranti vicino a te",
    supermarketTitle: "Supermercato pi√π vicino",
    restaurantsTitle: "Ristoranti consigliati",
    directions: "Indicazioni",
    open: "Aperto",
    closed: "Chiuso",
    closingSoon: "Chiude tra poco",
    walkMin: "min a piedi",
    supermarket: "Supermercato"
  },
  en: {
    subtitle: "Supermarkets and restaurants near you",
    supermarketTitle: "Nearest supermarket",
    restaurantsTitle: "Recommended restaurants",
    directions: "Directions",
    open: "Open",
    closed: "Closed",
    closingSoon: "Closing soon",
    walkMin: "min walk",
    supermarket: "Supermarket"
  }
};

// Supermarket data per apartment
const SUPERMARKETS = {
  sweet: {
    name: "Supermercato",
    distance: 3,
    link: "https://share.google/4quFxK1Tj6bwpHVp6"
  },
  skyline: {
    name: "Supermercato",
    distance: 3,
    link: "https://share.google/4quFxK1Tj6bwpHVp6"
  },
  dreamstudio: {
    name: "Supermercato",
    distance: 4,
    links: [
      { name: "Supermercato 1", link: "https://share.google/GdB8FQzQlxsmzi4x6" },
      { name: "Supermercato 2", link: "https://share.google/90DnJWemW5q6o2hnB" }
    ]
  },
  station: {
    name: "Supermercato",
    distance: 2,
    link: "https://share.google/N6sfwHkscsGnJmA3l"
  }
};

// Restaurant data with opening hours and distance per apartment
const RESTAURANTS = [
  {
    name: "Macch√©pasta",
    icon: "üçù",
    link: "https://share.google/6Vp47RGNlcse2fw8E",
    // 12-23 tutti i giorni
    getHours: function(day) {
      return { open: 12, close: 23 };
    },
    distance: { sweet: 3, skyline: 3, dreamstudio: 3, station: 3 }
  },
  {
    name: "Ristorante Pizzeria Da Michele",
    icon: "üçï",
    link: "https://share.google/Z2V10UwQi4yzpWBN8",
    // Lun-Gio: 09:30-23:30, Ven-Dom: 09-00
    getHours: function(day) {
      if (day >= 5 || day === 0) return { open: 9, close: 24 }; // Ven-Dom
      return { open: 9.5, close: 23.5 }; // Lun-Gio
    },
    distance: { sweet: 2, skyline: 2, dreamstudio: 4, station: 2 }
  },
  {
    name: "Antica Focacceria Fiorentina",
    icon: "ü•ñ",
    link: "https://share.google/9E6vXZfRrfXdkd0F5",
    // 07:30-15, 17:30-22:30 tutti i giorni
    getHours: function(day) {
      return { open: 7.5, close: 15, open2: 17.5, close2: 22.5 };
    },
    distance: { sweet: 4, skyline: 4, dreamstudio: 5, station: 1 }
  },
  {
    name: "Hostaria Vite Rossa",
    icon: "üç∑",
    link: "https://share.google/NQudGBjrUHPxpHC7X",
    // Lun-Mar: 09-15:30, Mer-Sab: 09-15:30 + 17:30-23, Dom: 09-15:30
    getHours: function(day) {
      if (day >= 3 && day <= 6) return { open: 9, close: 15.5, open2: 17.5, close2: 23 }; // Mer-Sab
      return { open: 9, close: 15.5 }; // Lun-Mar, Dom
    },
    distance: { sweet: 5, skyline: 5, dreamstudio: 6, station: 4 }
  },
  {
    name: "BEFED Brew Pub Mestre",
    icon: "üç∫",
    link: "https://share.google/cwHpCwOyhanz6HYEU",
    // Lun: 19-00, Mar-Gio: 12-14:30 + 19-00, Ven: 12-14:30 + 19-01, Sab: 18:30-01, Dom: 18:30-00
    getHours: function(day) {
      if (day === 1) return { open: 19, close: 24 }; // Lun
      if (day >= 2 && day <= 4) return { open: 12, close: 14.5, open2: 19, close2: 24 }; // Mar-Gio
      if (day === 5) return { open: 12, close: 14.5, open2: 19, close2: 25 }; // Ven (01:00)
      if (day === 6) return { open: 18.5, close: 25 }; // Sab
      return { open: 18.5, close: 24 }; // Dom
    },
    distance: { sweet: 7, skyline: 7, dreamstudio: 7, station: 6 }
  },
  {
    name: "Tacos Di Paris TURKISH Grill",
    icon: "üåÆ",
    link: "https://share.google/Z3GwCe9N9SAckA6Fq",
    // 12-23, Dom: 12-22:45
    getHours: function(day) {
      if (day === 0) return { open: 12, close: 22.75 }; // Dom
      return { open: 12, close: 23 };
    },
    distance: { sweet: 6, skyline: 6, dreamstudio: 1, station: 7 }
  },
  {
    name: "Panda Fly",
    icon: "ü•°",
    link: "https://share.google/Z3GwCe9N9SAckA6Fq",
    // 12-23, chiuso mercoled√¨
    getHours: function(day) {
      if (day === 3) return null; // Chiuso mercoled√¨
      return { open: 12, close: 23 };
    },
    distance: { sweet: 1, skyline: 1, dreamstudio: 2, station: 5 }
  }
];

function getStatus(restaurant) {
  const now = new Date();
  const day = now.getDay(); // 0=Dom, 1=Lun, etc.
  const currentHour = now.getHours();
  const currentMin = now.getMinutes();
  const currentTime = currentHour + currentMin / 60;
  
  const L = I18N[LANG];
  const hours = restaurant.getHours(day);
  
  // Chiuso oggi
  if (!hours) {
    return { status: "closed", text: L.closed };
  }
  
  // Controlla primo turno
  if (currentTime >= hours.open && currentTime < hours.close) {
    const timeUntilClose = hours.close - currentTime;
    if (timeUntilClose <= 1) {
      return { status: "closing", text: L.closingSoon };
    }
    return { status: "open", text: L.open };
  }
  
  // Controlla secondo turno se esiste
  if (hours.open2 && hours.close2) {
    if (currentTime >= hours.open2 && currentTime < hours.close2) {
      const timeUntilClose = hours.close2 - currentTime;
      if (timeUntilClose <= 1) {
        return { status: "closing", text: L.closingSoon };
      }
      return { status: "open", text: L.open };
    }
  }
  
  return { status: "closed", text: L.closed };
}

function renderWidget() {
  const L = I18N[LANG];
  const apt = document.getElementById("lv-apartment-select").value;
  
  // Update translations
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    if (L[key]) el.innerText = L[key];
  });
  
  // Render supermarket
  const supermarket = SUPERMARKETS[apt];
  const supermarketContainer = document.getElementById("lv-supermarket-container");
  
  if (supermarket.links) {
    // Multiple supermarkets (Dream Studio)
    supermarketContainer.innerHTML = supermarket.links.map((s, i) => `
      <div class="lv-supermarket-card" style="margin-bottom: ${i < supermarket.links.length - 1 ? '12px' : '0'}">
        <div class="lv-supermarket-icon">üõí</div>
        <div class="lv-supermarket-info">
          <div class="lv-supermarket-name">${L.supermarket} ${i + 1}</div>
          <div class="lv-supermarket-distance">~${supermarket.distance + i} ${L.walkMin}</div>
          <a href="${s.link}" target="_blank" rel="noopener" class="lv-supermarket-btn">
            üìç ${L.directions}
          </a>
        </div>
      </div>
    `).join('');
  } else {
    supermarketContainer.innerHTML = `
      <div class="lv-supermarket-card">
        <div class="lv-supermarket-icon">üõí</div>
        <div class="lv-supermarket-info">
          <div class="lv-supermarket-name">${L.supermarket}</div>
          <div class="lv-supermarket-distance">~${supermarket.distance} ${L.walkMin}</div>
          <a href="${supermarket.link}" target="_blank" rel="noopener" class="lv-supermarket-btn">
            üìç ${L.directions}
          </a>
        </div>
      </div>
    `;
  }
  
  // Sort restaurants by distance
  const sortedRestaurants = [...RESTAURANTS].sort((a, b) => 
    a.distance[apt] - b.distance[apt]
  );
  
  // Render restaurants
  const restaurantList = document.getElementById("lv-restaurant-list");
  restaurantList.innerHTML = sortedRestaurants.map((r, idx) => {
    const status = getStatus(r);
    const statusClass = status.status === "open" ? "lv-status-open" : 
                        status.status === "closing" ? "lv-status-closing" : "lv-status-closed";
    
    return `
      <div class="lv-restaurant-card" data-idx="${idx}" onclick="selectRestaurant(this)">
        <div class="lv-restaurant-icon">${r.icon}</div>
        <div class="lv-restaurant-info">
          <div class="lv-restaurant-name">${r.name}</div>
          <div class="lv-restaurant-meta">
            <span class="lv-restaurant-distance">~${r.distance[apt]} ${L.walkMin}</span>
            <span class="lv-restaurant-status ${statusClass}">${status.text}</span>
          </div>
        </div>
        <a href="${r.link}" target="_blank" rel="noopener" class="lv-restaurant-btn" onclick="event.stopPropagation()">üìç</a>
      </div>
    `;
  }).join('');
}

// Select restaurant function
function selectRestaurant(card) {
  // Remove selected class from all cards
  document.querySelectorAll('.lv-restaurant-card').forEach(c => c.classList.remove('selected'));
  // Add selected class to clicked card
  card.classList.add('selected');
}

// Events
document.getElementById("lv-lang-select").addEventListener("change", e => {
  LANG = e.target.value;
  renderWidget();
});

document.getElementById("lv-apartment-select").addEventListener("change", renderWidget);

// Init
renderWidget();

// Update status every minute
setInterval(renderWidget, 60000);
</script>

</body>
</html>
